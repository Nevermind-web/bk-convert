<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>TEST BK CONVERT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family: Arial, sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
.box{
  border:2px dashed #38bdf8;
  padding:40px;
  cursor:pointer;
}
input{display:none}
</style>
</head>

<body>

<div class="box" id="box">
  KLIKNI SEM A VYBER SOUBOR
</div>

<input type="file" id="file">

<script>
document.addEventListener("DOMContentLoaded", () => {

  const drop = document.getElementById("box");
  const fileInput = document.getElementById("file");
  const convertBtn = document.getElementById("convertBtn");

  let files = [];

  // Zabránění výchozímu chování
  ["dragenter","dragover","dragleave","drop"].forEach(event => {
    document.addEventListener(event, e => {
      e.preventDefault();
      e.stopPropagation();
    });
  });

  // DROP
  drop.addEventListener("drop", (e) => {
    files = [...e.dataTransfer.files];
    updateUI();
  });

  // KLIK
  drop.addEventListener("click", () => {
    fileInput.click();
  });

  fileInput.addEventListener("change", (e) => {
    files = [...e.target.files];
    updateUI();
  });

  function updateUI(){
    if (!files.length) return;
    drop.innerHTML = `
      <strong>Vybráno souborů:</strong><br>
      ${files.map(f => f.name).join("<br>")}
    `;
  }

  // PŘEVOD OBRÁZKŮ
  convertBtn.addEventListener("click", () => {
    if (!files.length) {
      alert("Nejdřív vyber soubory");
      return;
    }

    files.forEach(file => {
      if (!file.type.startsWith("image/")) return;

      const img = new Image();
      img.src = URL.createObjectURL(file);

      img.onload = () => {
        const canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;

        const ctx = canvas.getContext("2d");
        ctx.fillStyle = "#fff";
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.drawImage(img,0,0);

        const url = canvas.toDataURL("image/jpeg", 0.95);

        const a = document.createElement("a");
        a.href = url;
        a.download = file.name.replace(/\.[^/.]+$/, "") + ".jpg";
        a.click();
      };
    });
  });

});
</script>


</body>
</html>






